' Gambas class file

Public bts As Byte

Public Sub Form_Open()

  With systembackgui

    If bts = 1

      windowmaximize.Hide
      windowminimize.X = 2
      windowclose.Hide
      windowbuttons.Move(.X + .W - 36, .Y - 12, 1, 1)

    Else If bts = 2

      windowmaximize.Hide
      windowminimize.X = 2
      windowclose.X = 47
      windowbuttons.Move(.X + .W - 81, .Y - 12, 1, 1)

    Else

      With systembackgui

        If .W = Screen.AvailableWidth And .H = Screen.AvailableHeight

          windowmaximize.Text = "▭"
          windowbuttons.Move(.X + .W - 138, .Y, 1, 1)

        Else

          windowbuttons.Move(.X + .W - 126, .Y - 12, 1, 1)

        Endif

      End With

    Endif

  End With

End

Public Sub unitimer_Timer()

  With windowbuttons

    If .W <> 48 And .W <> 93 And .W <> 138

      If bts = 1

        .Resize(48, 48)

      Else If bts = 2

        .Resize(93, 48)

      Else

        .Resize(138, 48)

      Endif

    Else If Mouse.Inside(windowbuttons) = False

      .Close

    Else If Mouse.Inside(windowclose) = True And windowclose.Background = Color.TextForeground

      windowclose_Enter

    Endif

  End With

End

Public Sub windowmaximize_MouseDown()

  If Mouse.Left = True Then windowmaximize.Foreground = Color.SelectedBackground

End

Public Sub windowmaximize_MouseUp()

  If windowmaximize.Foreground = Color.SelectedBackground

    windowbuttons.Close

    With systembackgui

      If windowmaximize.Text = "□"

        .winx = .X
        .winy = .Y
        .winw = .W
        .winh = .H

        .Move(0, 0, Screen.AvailableWidth, Screen.AvailableHeight)

      Else

        .Resize(1, 1)

        Wait 0.15

        .Move(.winx, .winy, .winw, .winh)

      Endif

    End With

  Endif

End

Public Sub windowmaximize_Enter()

  With windowmaximize

    If .Background = Color.TextForeground

      .Background = Color.TextBackground
      If .Foreground <> Color.SelectedBackground Then .Foreground = Color.TextForeground

    Endif

  End With

End

Public Sub windowmaximize_Leave()

  With windowmaximize

    If .Background = Color.TextBackground

      .Background = Color.TextForeground
      If .Foreground <> Color.SelectedBackground Then .Foreground = Color.TextBackground

    Endif

  End With

End

Public Sub windowminimize_MouseDown()

  If Mouse.Left = True Then windowminimize.Foreground = Color.SelectedBackground

End

Public Sub windowminimize_MouseUp()

  If windowminimize.Foreground = Color.SelectedBackground

    windowbuttons.Close
    systembackgui.Minimized = True

  Endif

End

Public Sub windowminimize_Enter()

  With windowminimize

    If .Background = Color.TextForeground

      .Background = Color.TextBackground
      If .Foreground <> Color.SelectedBackground Then .Foreground = Color.TextForeground

    Endif

  End With

End

Public Sub windowminimize_Leave()

  With windowminimize

    If .Background = Color.TextBackground

      .Background = Color.TextForeground
      If .Foreground <> Color.SelectedBackground Then .Foreground = Color.TextBackground

    Endif

  End With

End

Public Sub windowclose_MouseDown()

  If Mouse.Left = True Then windowclose.Foreground = Color.SelectedBackground

End

Public Sub windowclose_MouseUp()

  If windowclose.Foreground = Color.SelectedBackground Then systembackgui.Close

End

Public Sub windowclose_Enter()

  With windowclose

    If .Background = Color.TextForeground

      .Background = Color.TextBackground
      If .Foreground <> Color.SelectedBackground Then .Foreground = Color.TextForeground

    Endif

  End With

End

Public Sub windowclose_Leave()

  With windowclose

    If .Background = Color.TextBackground

      .Background = Color.TextForeground
      If .Foreground <> Color.SelectedBackground Then .Foreground = Color.TextBackground

    Endif

  End With

End
